
HWindowBar=HButton.extend({packageName:"window",componentName:"windowbar",constructor:function(_1,_7,_2){if(!_2){_2={};}
if(!_2.events){_2.events={};}
if(!_2.events.draggable){_2.events.draggable=true;}
if(this.isinherited){this.base(_1,_7,_2);}
else{this.isinherited=true;this.base(_1,_7,_2);this.isinherited=false;}
this.type='[HWindowBar]';if(!this.isinherited){this.draw();}},setLabel:function(_u){this.label=_u;if(this.parent.windowLabel){this.parent.windowLabel.setLabel(_u);}},startDrag:function(_8,_a){this.parent.startDrag(_8,_a);},doDrag:function(_8,_a){this.parent.doDrag(_8,_a);},endDrag:function(_8,_a){this.parent.endDrag(_8,_a);}});HWindowLabel=HButton.extend({packageName:"window",componentName:"windowlabel",constructor:function(_1,_7,_2){if(!_2){_2={};}
if(!_2.events){_2.events={};}
if(!_2.events.draggable){_2.events.draggable=true;}
if(this.isinherited){this.base(_1,_7,_2);}
else{this.isinherited=true;this.base(_1,_7,_2);this.isinherited=false;}
this.type='[HWindowLabel]';if(!this.isinherited){this.draw();}},gainedActiveStatus:function(_0d){HEventManager.changeActiveControl(this.parent.parent);},startDrag:function(_8,_a){this.parent.parent.startDrag(_8,_a);},doDrag:function(_8,_a){this.parent.parent.doDrag(_8,_a);},endDrag:function(_8,_a){this.parent.parent.endDrag(_8,_a);}});HWindowView=HView.extend({packageName:"window",componentName:"windowview",constructor:function(_1,_7){if(this.isinherited){this.base(_1,_7);}
else{this.isinherited=true;this.base(_1,_7);this.isinherited=false;}
this.type='[HWindowView]';this.preserveTheme=true;if(!this.isinherited){this.draw();}},draw:function(){if(!this.drawn){this.drawMarkup();var _0R=this.bindDomElement(HWindowView._1B+this.elemId);if(!_0R){throw("HWindowView: The HTML template must have an element with "+"the ID '"+HWindowView._1B+" + this.elemId'.");}
elem_append(this.parent.elemId,_0R);elem_append(0,this.elemId);elem_del(this.elemId);elem_replace(this.elemId,elem_get(_0R));}
this.drawRect();}},{_1B:"windowview"});HWindowControl=HControl.extend({packageName:"window",componentName:"windowcontrol",constructor:function(_1,_7,_2){if(!_2){_2={};}
var _z=Base.extend({minSize:[64,32],maxSize:[4096,3072],barHeight:21,resizeW:4,resizeE:4,resizeN:4,resizeS:4,resizeNW:[4,4],resizeNE:[4,4],resizeSW:[4,4],resizeSE:[16,16],menuBar:null});_2=new(_z.extend(_2))();if(this.isinherited){this.base(_1,_7,_2);}
else{this.isinherited=true;this.base(_1,_7,_2);this.isinherited=false;}
this.type='[HWindowControl]';this.preserveTheme=true;this._2R();this.setDraggable(true);this.drawRect();this.drawMarkup();this.buildWinParts();this.setLabel(this.label);if(_2.menuBar){this.setMenuBar(_2.menuBar);}
if(!this.isinherited){this.draw();}},buildWinParts:function(){this.calcWindowPartRects();this.windowBar=new HWindowBar(this._g.windowBarRect,this,{label:this.label});this.windowBar.draw();this.windowLabel=new HWindowLabel(this._g.windowLabelRect,this.windowBar,{label:this.label});this.windowLabel.draw();this.windowView=new HWindowView(this._g.windowViewRect,this);this.windowView.draw();},_2R:function(){this._g={dragWindow:false,resizeW:false,resizeE:false,resizeN:false,resizeS:false,resizeNW:false,resizeNE:false,resizeSW:false,resizeSE:false,dragWindowRect:new HRect(this.options.resizeW,this.options.resizeN,this.rect.width-this.options.resizeE,this.options.barHeight+this.options.resizeN),resizeNRect:new HRect(this.options.resizeW,0,this.rect.width-this.options.resizeE,this.options.resizeN),resizeSRect:new HRect(this.options.resizeW,this.rect.height-this.options.resizeS,this.rect.width-this.options.resizeE,this.rect.height),resizeWRect:new HRect(0,this.options.resizeN,this.options.resizeW,this.rect.height-this.options.resizeS),resizeERect:new HRect(this.rect.width-this.options.resizeE,this.options.resizeN,this.rect.width,this.rect.height-this.options.resizeS),resizeNWRect:new HRect(0,0,this.options.resizeNW[0],this.options.resizeNW[1]),resizeNERect:new HRect(this.rect.width-this.options.resizeNE[0],0,this.rect.width,this.options.resizeNE[1]),resizeSWRect:new HRect(0,this.rect.height-this.options.resizeSW[1],this.options.resizeSW[0],this.rect.height),resizeSERect:new HRect(this.rect.width-this.options.resizeSE[0],this.rect.height-this.options.resizeSE[1],this.rect.width,this.rect.height)};},checkWindowSizeConstrains:function(){var _4e=this._g.resizeW||this._g.resizeSW||this._g.resizeNW;var _4d=this._g.resizeN||this._g.resizeNE||this._g.resizeNW;if(this.rect.width<this.options.minSize[0]){if(_4e){this.rect.left=this.rect.right-this.options.minSize[0];}
this.rect.setWidth(this.options.minSize[0]);}else if(this.rect.width>this.options.maxSize[0]){if(_4e){this.rect.left=this.rect.right-this.options.maxSize[0];}
this.rect.setWidth(this.options.maxSize[0]);}
if(this.rect.height<this.options.minSize[1]){if(_4d){this.rect.top=this.rect.bottom-this.options.minSize[1];}
this.rect.setHeight(this.options.minSize[1]);}else if(this.rect.height>this.options.maxSize[1]){if(_4d){this.rect.top=this.rect.bottom-this.options.maxSize[1];}
this.rect.setHeight(this.options.maxSize[1]);}
var _2C=0-this.options.resizeW;if(this.rect.left<_2C){this.rect.left=_2C;this.rect.right=this.rect.width+_2C;}
var _33=0-this.options.resizeN;if(this.rect.top<_33){this.rect.top=_33;this.rect.bottom=this.rect.height+_33;}},startDrag:function(_8,_a){this._0x=new HPoint(_8,_a);this._20=new HPoint(_8,_a);this._1y=new HRect(this.rect);this._2R();var _0f=this._0x.subtract(this._1y.leftTop);if(this._g.resizeNWRect.contains(_0f)){this._A=_0f;this._g.resizeNW=true;}else if(this._g.resizeNERect.contains(_0f)){this._A=this._0x.subtract(this._1y.rightTop);this._g.resizeNE=true;}else if(this._g.resizeSWRect.contains(_0f)){this._A=this._0x.subtract(this._1y.leftBottom);this._g.resizeSW=true;}else if(this._g.resizeSERect.contains(_0f)){this._A=this._0x.subtract(this._1y.rightBottom);this._g.resizeSE=true;}else if(this._g.resizeNRect.contains(_0f)){this._A=_a-this.rect.top;this._g.resizeN=true;}else if(this._g.resizeSRect.contains(_0f)){this._A=_a-this.rect.bottom;this._g.resizeS=true;}else if(this._g.resizeWRect.contains(_0f)){this._A=_8-this.rect.left;this._g.resizeW=true;}else if(this._g.resizeERect.contains(_0f)){this._A=_8-this.rect.right;this._g.resizeE=true;}else if(this._g.dragWindowRect.contains(_0f)){this._A=this._0x.subtract(this._1y.leftTop);this._g.dragWindow=true;}
this.bringToFront();this.doDrag(_8,_a);},doDrag:function(_8,_a){var _k;var _0E=new HPoint(_8,_a);if(!this._20.equals(_0E)){if(this._g.resizeNW==true){_k=_0E.subtract(this._A);this.rect.setLeftTop(_k);}else if(this._g.resizeNE==true){_k=_0E.subtract(this._A);this.rect.setRightTop(_k);}else if(this._g.resizeSW==true){_k=_0E.subtract(this._A);this.rect.setLeftBottom(_k);}else if(this._g.resizeSE==true){_k=_0E.subtract(this._A);this.rect.setRightBottom(_k);}else if(this._g.resizeN==true){_k=_a-this._A;this.rect.top=_k;this.rect.updateSecondaryValues();}else if(this._g.resizeS==true){_k=_a-this._A;this.rect.bottom=_k;this.rect.updateSecondaryValues();}else if(this._g.resizeW==true){_k=_8-this._A;this.rect.left=_k;this.rect.updateSecondaryValues();}else if(this._g.resizeE==true){_k=_8-this._A;this.rect.right=_k;this.rect.updateSecondaryValues();}else if(this._g.dragWindow==true){_k=_0E.subtract(this._A);this.rect.offsetTo(_k);}
this.checkWindowSizeConstrains();this.setStyle('left',this.rect.left+'px',true);this.setStyle('top',this.rect.top+'px',true);this.setStyle('width',this.rect.width+'px',true);this.setStyle('height',this.rect.height+'px',true);if(this._g.dragWindow==false){this.calcWindowPartRects();}
this._20=_0E;}},endDrag:function(_8,_a){this.doDrag(_8,_a);},calcWindowPartRects:function(){var _2d=new HRect(this.options.resizeW,this.options.resizeN,this.rect.width-this.options.resizeE,this.options.barHeight+this.options.resizeN);var _4B=new HRect(0,0,_2d.width,_2d.height);var _1D=new HRect(this.options.resizeW,this.options.resizeN+this.options.barHeight,this.rect.width-this.options.resizeE,this.rect.height-this.options.resizeS);if(this.menuBar){var _1W=this.options.menuBarHeight;if(_1W+this.options.resizeN+this.options.barHeight>this.rect.height-this.options.resizeS){_1W=this.rect.height-this.options.barHeight-
this.options.resizeS-this.options.resizeN;}
_1D.setTop(_1D.top+_1W);this.menuBar.resizeTo(_1D.width,_1W);}
if(!this._g.windowBarRect){this._g.windowBarRect=_2d;this._g.windowLabelRect=_4B;this._g.windowViewRect=_1D;}else{this.windowBar.setRect(_2d);this.windowLabel.setRect(_4B);this.windowView.setRect(_1D);}},draw:function(){this.drawRect();},setLabel:function(_u){if(this.drawn&&this.windowLabel){this.windowLabel.setLabel(_u);}
this.base(_u);},refresh:function(){if(this.windowBar){this.windowBar.refresh();}
this.drawRect();},setMenuBar:function(_1V){if(_1V==this.menuBar){return;}
if(this.menuBar){this.menuBar.die();}
this.menuBar=_1V;if(_1V){this.options.menuBarHeight=this.menuBar.rect.height;this.menuBar.remove();this.addView(this.menuBar);elem_append(this.elemId,this.menuBar.elemId);this.menuBar.moveTo(this.windowView.rect.left,this.windowBar.rect.bottom);}
this.calcWindowPartRects();}});HWindow=HWindowControl;